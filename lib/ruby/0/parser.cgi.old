#!c:/cygwin/usr/local/bin/ruby

  require 'cgi'
  require 'oboe'; require 'oboe/samples'

  include Oboe

  cgi = CGI.new; args = cgi.params

  output = 'xml'

  if args.has_key?('OpenURL')
    output = "#{args['Parse']}"
    args = CGI::parse(args['OpenURL'][0])
  end

  # If no querystring present select a random sample
  if args.empty?
    args = CGI::parse(Samples.new.querystring)
  end

  begin
    if output == 'txt'
      print "content-type: text/html\n\n"
      print "<body>\n<pre>\n"
      print OpenURL.new(args).to_s
      print "</pre>\n</body>\n"
    elsif output == 'xml'
      print "content-type: text/xml\n\n"
      print OpenURL.new(args).to_xml
    end
  rescue
    # what now?
  end

